# 信息收集

## 企业信息网站

| **标签**   | **名称**     | **地址**                             |
| ---------- | ------------ | ------------------------------------ |
| 企业信息   | 天眼查       | https://www.tianyancha.com/          |
| 企业信息   | 小蓝本       | https://www.xiaolanben.com/          |
| 企业信息   | 爱企查       | https://aiqicha.baidu.com/           |
| 企业信息   | 企查查       | https://www.qcc.com/                 |
| 企业信息   | 国外企查     | https://opencorporates.com/          |
| 企业信息   | 启信宝       | https://www.qixin.com/               |
| 备案信息   | 备案管理系统 | https://beian.miit.gov.cn/           |
| 备案信息   | 备案信息查询 | http://www.beianx.cn/                |
| 公众号信息 | 搜狗微信搜索 | https://weixin.sogou.com/            |
| 注册域名   | 域名注册查询 | https://buy.cloud.tencent.com/domain |

------

## DNS&证书&IP反查网站

| **标签** | **名称**          | **地址**                  |
| -------- | ----------------- | ------------------------- |
| DNS数据  | dnsdumpster       | https://dnsdumpster.com/  |
| 证书查询 | CertificateSearch | https://crt.sh/           |
| IP反查   | IP反查域名        | https://x.threatbook.cn/  |
| IP反查   | IP反查域名        | http://dns.bugscaner.com/ |

------

## 枚举解析网站

| 标签     | 名称                   | 地址                                   |
| -------- | ---------------------- | -------------------------------------- |
| 枚举解析 | 在线子域名查询         | http://tools.bugscaner.com/subdomain/  |
| 枚举解析 | DNSGrep子域名查询      | https://www.dnsgrep.cn/subdomain       |
| 枚举解析 | 工具强大的子域名收集器 | https://github.com/shmilylty/OneForAll |

------

## 指纹识别网站



| **标签** | **名称**         | **地址**                                   |
| -------- | ---------------- | ------------------------------------------ |
| 指纹识别 | 在线cms指纹识别  | http://whatweb.bugscaner.com/look/         |
| 指纹识别 | Wappalyzer       | https://github.com/AliasIO/wappalyzer      |
| 指纹识别 | TideFinger潮汐   | http://finger.tidesec.net/                 |
| 指纹识别 | 云悉指纹         | https://www.yunsee.cn/                     |
| 指纹识别 | WhatWeb          | https://github.com/urbanadventurer/WhatWeb |
| 指纹识别 | 数字观星Finger-P | https://fp.shuziguanxing.com/#/            |

------

## 网络空间网站

| **标签** | **名称**            | **地址**                                                  |
| -------- | ------------------- | --------------------------------------------------------- |
| 网络空间 | FOFA                | https://fofa.info/                                        |
| 网络空间 | 全球鹰              | http://hunter.qianxin.com/                                |
| 网络空间 | 360                 | https://quake.360.cn/quake                                |
| 网络空间 | 钟馗之眼            | [https://www.zoomeye.org/](https://www.zoomeye.org/?R1nG) |
| 网络空间 | Shodan              | https://www.shodan.io/                                    |
| 网络空间 | Censys              | https://censys.io/                                        |
| 网络空间 | ONYPHE              | https://www.onyphe.io/                                    |
| 网络空间 | FullHunt            | https://fullhunt.io/                                      |
| 网络空间 | Soall Search Engine | https://soall.org/                                        |
| 网络空间 | Netlas              | https://app.netlas.io/responses/                          |
| 网络空间 | Leakix              | https://leakix.net/                                       |
| 网络空间 | 零零信安            | https://0.zone/                                           |
| 网络空间 | DorkSearch          | https://dorksearch.com/                                   |

------

## 威胁情报网站

| 标签     | 名称                   | 地址                                                         |
| -------- | ---------------------- | ------------------------------------------------------------ |
| 威胁情报 | 微步在线 情报社区      | https://x.threatbook.cn/                                     |
| 威胁情报 | 奇安信 威胁情报中心    | https://ti.qianxin.com/                                      |
| 威胁情报 | 360 威胁情报中心       | https://ti.360.cn/#/homepage                                 |
| 威胁情报 | VirusTotal在线查杀平台 | https://www.virustotal.com/gui/                              |
| 威胁情报 | VenusEye 威胁情报中心  | https://www.venuseye.com.cn/                                 |
| 威胁情报 | 绿盟科技 威胁情报云    | https://ti.nsfocus.com/                                      |
| 威胁情报 | IBM 情报中心           | https://exchange.xforce.ibmcloud.com/                        |
| 威胁情报 | 天际友盟安全智能平台   | [https://redqueen.tj-un.com](https://redqueen.tj-un.com/IntelHome.html) |
| 威胁情报 | 华为安全中心平台       | [https://isecurity.huawei.com/sec](https://isecurity.huawei.com/sec/web/intelligencePortal.do) |
| 威胁情报 | 安恒威胁情报中心       | https://ti.dbappsecurity.com.cn/                             |
| 威胁情报 | AlienVault             | https://otx.alienvault.com/                                  |
| 威胁情报 | 深信服                 | [https://sec.sangfor.com.cn/](https://sec.sangfor.com.cn/analysis-platform) |
| 威胁情报 | 丁爸情报分析师的工具箱 | http://dingba.top/                                           |
| 威胁情报 | 听风者情报源 start.me  | https://start.me/p/X20Apn                                    |
| 威胁情报 | GreyNoise Visualizer   | https://viz.greynoise.io/                                    |
| 威胁情报 | URLhaus 数据库         | https://urlhaus.abuse.ch/browse/                             |

------

# 信息收集主要的业务资产

##### 1、web应用

##### 2、APP应用

##### 3、PC端应用

##### 4、小程序应用

##### 5、微信公众号

##### 6、其他业务

# 一、web应用

## 1、架构

- 1、程序语言
- 2、框架源码
- 3、搭建平台
- 4、数据库类
- 5、操作系统

## 2、域名

#### 1、查询web单域名

通过<u>备案信息</u>，<u>企业产权</u>，<u>注册域名</u>，<u>反查解析</u>来查询web的域名；

#### 2、查询web子域名

通过<u>DNS数据</u>、<u>证书查询</u>、<u>网络空间</u>、<u>威胁情报</u>、<u>枚举解析</u>来查询web子域名；

#### 3、查询web架构资产

主要包括<u>程序语言</u>、<u>框架源码</u>、<u>搭建平台</u>、<u>数据库类型</u>、<u>操作系统</u>；

## 3、源码获取（后端）

### （1）、源码泄漏原因

- 1、从源码本身的特性入口
- 2、从管理员不好的习惯入口
- 3、从管理员不好的配置入口
- 4、从管理员不好的意识入口
- 5、从管理员资源信息搜集入口

### （2）、源码泄漏集合

- composer.json
- git源码泄露
- svn源码泄露
- hg源码泄漏
- 网站备份压缩文件
- WEB-INF/web.xml 泄露
- DS_Store 文件泄露
- SWP 文件泄露
- CVS泄露
- Bzr泄露
- GitHub源码泄漏

### （3）、配置不当-源码泄漏

参考：https://www.secpulse.com/archives/124398.html

备份：敏感目录文件扫描

- CVS：https://github.com/kost/dvcs-ripper
- GIT：https://github.com/lijiejie/GitHack
- SVN：https://github.com/callmefeifei/SvnHack
- DS_Store：https://github.com/lijiejie/ds_store_exp

### （4）、资源GITHUB-源码泄漏

- 解决1：识别出大致信息却无下载资源
- 解决2：未识别出信息使用码云资源获取
- 解决3：其他行业开发使用对口资源站获取

涉及：

- https://gitee.com/
- https://github.com/
- https://www.huzhan.com/

GITHUB资源搜索：

```text
in:name test               #仓库标题搜索含有关键字 
in:descripton test         #仓库描述搜索含有关键字 
in:readme test             #Readme文件搜素含有关键字 
stars:>3000 test           #stars数量大于3000的搜索关键字 
stars:1000..3000 test      #stars数量大于1000小于3000的搜索关键字 
forks:>1000 test           #forks数量大于1000的搜索关键字 
forks:1000..3000 test      #forks数量大于1000小于3000的搜索关键字 
size:>=5000 test           #指定仓库大于5000k(5M)的搜索关键字 
pushed:>2019-02-12 test    #发布时间大于2019-02-12的搜索关键字 
created:>2019-02-12 test   #创建时间大于2019-02-12的搜索关键字 
user:test                  #用户名搜素 
license:apache-2.0 test    #明确仓库的 LICENSE 搜索关键字 
language:java test         #在java语言的代码中搜索关键字 
user:test in:name test     #组合搜索,用户名test的标题含有test的
```

关键字配合谷歌搜索：

```text
site:Github.com smtp   
site:Github.com smtp @qq.com   
site:Github.com smtp @126.com   
site:Github.com smtp @163.com   
site:Github.com smtp @sina.com.cn 
site:Github.com smtp password 
site:Github.com String password smtp
```

## 4、JS前端架构	

0、什么是JS渗透测试？

​    在Javascript中也存在变量和函数，当存在可控变量及函数调用即可参数漏洞

JS开发的WEB应用和PHP，JAVA,NET等区别在于即没有源代码，也可以通过浏览器的查看源代码获取真实的点。获取URL，获取JS敏感信息，获取代码传参等

所以相当于JS开发的WEB应用属于白盒测试（默认有源码参考），一般会在<u>JS中寻找更多的URL地址</u>，在<u>JS代码逻辑（加密算法，APIkey配置，验证逻辑等）</u>进行后期安全测试。

前提：Web应用可以采用后端或前端语言开发

- -后端语言：php java python .NET 浏览器端看不到真实的源代码（黑盒测试）

- -前端语言：JavaScript(JS)和JS框架 浏览器端看到真实的源代码（白盒测试）

流行的Js框架：Vue   NodeJS    jQuery   Angular等

### （1）、JS安全问题

- ​    源码泄漏
- ​    未授权访问：JS里面分析更多的URL访问确定接口路径
- ​    敏感key泄漏：JS文件中可能配置了接口信息（云应用，短信，邮件，数据库等）
- ​    API接口安全：（代码中加密提交参数传递，更多的URL路径）

### （2）、如何判定JS开发应用？

- ​    插件wappalyzer
- ​    源程序代码简短
- ​    引入多个js文件

​					    一般有/static/js/app.js等顺序的js文件

 					   一般cookie中有connect.sid

### （3）、如何获取更多的JS文件？

**a、手工-浏览器搜索**

- 使用插件wappalyzer判断是否是JS框架；
- 使用F12检查网页代码，检测JS文件，全局搜索，快速获取价值信息

```html
    src=
    path=
    method:"get"
    http.get("
    method:"post"
    http.post("
    $.ajax
    http://service.httppost
    http://service.httpget
```

**b、半自动-Burpsuite插件**

- 自带功能：Target->sitemap->Engagement tools->Find scripts
- 官方插件：JS Link Finder & JS Miner
- 第三方插件：HaE & Unexpected_information
- 插件加载器：jython-standalone-2.7.2

```
Unexpected_information：
https://github.com/ScriptKid-Beta/Unexpected_information
用来标记请求包中的一些敏感信息、JS接口和一些特殊字段，
防止我们疏忽了一些数据包，使用它可能会有意外的收获信息。

HaE：
https://github.com/gh0stkey/HaE
需要修改config配置文件：https://raw.githubusercontent.com/gh0stkey/HaE/gh-pages/Config.yml
基于BurpSuite插件JavaAPI开发的请求高亮标记与信息提取的辅助型插件。该插件可以通过自定义正则的方式匹配响应报文或请求报文，可以自行决定符合该自定义正则匹配的相应请求是否需要高亮标记、信息提取。
```

**c、工具化-各类提取&FUZZ项目**

```
Jsfinder-从表现中JS中提取URL或者敏感数据

https://github.com/Threezh1/JSFinder
一款用作快速在网站的js文件中提取URL，子域名的工具
```

```
URLFinder-从表现中JS中提取URL或者敏感数据

https://github.com/pingc0y/URLFinder
一款用于快速提取检测页面中JS与URL的工具。
功能类似于JSFinder，但JSFinder好久没更新了。
```

```
JSINFO-SCAN-从表现中JS中提取URL或者敏感数据

https://github.com/p1g3/JSINFO-SCAN
递归爬取域名(netloc/domain)，以及递归从JS中获取信息的工具
```

```
FindSomething-从表现中JS中提取URL或者敏感数据---游览器插件

https://github.com/momosecurity/FindSomething
该工具是用于快速在网页的html源码或js代码中提取一些有趣的信息的浏览器插件，
包括请求的资源、接口的url，请求的ip和域名，泄漏的证件号、手机号、邮箱等信息。
```

```
ffuf-FUZZ爆破找到更多的js文件分析更多的信息 重点

https://github.com/ffuf/ffuf
字典下载网址：https://wordlists.assetnote.io
功能强大的模糊化工具，用它来FUZZ模糊化js文件。
跑出更多的js文件，再使用其他工具分析
```

```
Packer-Fuzzer-针对JS框架开发打包器Webpack检测

https://github.com/rtcatc/Packer-Fuzzer
一款针对Webpack等前端打包工具所构造的网站进行快速、高效安全检测的扫描工具
```

## 5、端口扫描

### （1）、常见的端口

| **端口**                          | **服务**              | **渗透用途**                                                 |
| --------------------------------- | --------------------- | ------------------------------------------------------------ |
| tcp 20,21                         | FTP                   | 允许匿名的上传下载,爆破,嗅探,win提权,远程执行(proftpd 1.3.5),各类后门(proftpd,vsftp 2.3.4) |
| tcp 22                            | SSH                   | 可根据已搜集到的信息尝试爆破,v1版本可中间人,ssh隧道及内网代理转发,文件传输等等 |
| tcp 23                            | Telnet                | 爆破,嗅探,一般常用于路由,交换登陆,可尝试弱口令               |
| tcp 25                            | SMTP                  | 邮件伪造,vrfy/expn查询邮件用户信息,可使用smtp-user-enum工具来自动跑 |
| tcp/udp 53                        | DNS                   | 允许区域传送,dns劫持,缓存投毒,欺骗以及各种基于dns隧道的远控  |
| tcp/udp 69                        | TFTP                  | 尝试下载目标及其的各类重要配置文件                           |
| tcp 80-89,443,8440-8450,8080-8089 | 各种常用的Web服务端口 | 可尝试经典的topn,vpn,owa,webmail,目标oa,各类Java控制台,各类服务器Web管理面板,各类Web中间件漏洞利用,各类Web框架漏洞利用等等…… |
| tcp 110                           | POP3                  | 可尝试爆破,嗅探                                              |
| tcp 111,2049                      | NFS                   | 权限配置不当                                                 |
| tcp 137,139,445                   | Samba                 | 可尝试爆破以及smb自身的各种远程执行类漏洞利用,如,ms08-067,ms17-010,嗅探等…… |
| tcp 143                           | IMAP                  | 可尝试爆破                                                   |
| udp 161                           | SNMP                  | 爆破默认团队字符串,搜集目标内网信息                          |
| tcp 389                           | LDAP                  | ldap注入,允许匿名访问,弱口令                                 |
| tcp 512,513,514                   | Linux rexec           | 可爆破,rlogin登陆                                            |
| tcp 873                           | Rsync                 | 匿名访问,文件上传                                            |
| tcp 1194                          | OpenVPN               | 想办法钓VPN账号,进内网                                       |
| tcp 1352                          | Lotus                 | 弱口令,信息泄漏,爆破                                         |
| tcp 1433                          | SQL Server            | 注入,提权,sa弱口令,爆破                                      |
| tcp 1521                          | Oracle                | tns爆破,注入,弹shell…                                        |
| tcp 1500                          | ISPmanager            | 弱口令                                                       |
| tcp 1723                          | PPTP                  | 爆破,想办法钓VPN账号,进内网                                  |
| tcp 2082,2083                     | cPanel                | 弱口令                                                       |
| tcp 2181                          | ZooKeeper             | 未授权访问                                                   |
| tcp 2601,2604                     | Zebra                 | 默认密码zerbra                                               |
| tcp 3128                          | Squid                 | 弱口令                                                       |
| tcp 3312,3311                     | kangle                | 弱口令                                                       |
| tcp 3306                          | MySQL                 | 注入,提权,爆破                                               |
| tcp 3389                          | Windows rdp           | shift后门[需要03以下的系统],爆破,ms12-020                    |
| tcp 3690                          | SVN                   | svn泄露,未授权访问                                           |
| tcp 4848                          | GlassFish             | 弱口令                                                       |
| tcp 5000                          | Sybase/DB2            | 爆破,注入                                                    |
| tcp 5432                          | PostgreSQL            | 爆破,注入,弱口令                                             |
| tcp 5900,5901,5902                | VNC                   | 弱口令爆破                                                   |
| tcp 5984                          | CouchDB               | 未授权导致的任意指令执行                                     |
| tcp 6379                          | Redis                 | 可尝试未授权访问,弱口令爆破                                  |
| tcp 7001,7002                     | WebLogic              | Java反序列化,弱口令                                          |
| tcp 7778                          | Kloxo                 | 主机面板登录                                                 |
| tcp 8000                          | Ajenti                | 弱口令                                                       |
| tcp 8009                          | tomcat Ajp            | Tomcat-Ajp协议漏洞                                           |
| tcp 8443                          | Plesk                 | 弱口令                                                       |
| tcp 8069                          | Zabbix                | 远程执行,SQL注入                                             |
| tcp 8080-8089                     | Jenkins,JBoss         | 反序列化,控制台弱口令                                        |
| tcp 9080-9081,9090                | WebSphere             | Java反序列化/弱口令                                          |
| tcp 9200,9300                     | ElasticSearch         | 远程执行                                                     |
| tcp 11211                         | Memcached             | 未授权访问                                                   |
| tcp 27017,27018                   | MongoDB               | 爆破,未授权访问                                              |
| tcp 50070,50030                   | Hadoop                | 默认端口未授权访问                                           |

### （2）、端口扫描工具

nmap：https://blog.csdn.net/qq_53079406/article/details/125263917

mascan：https://blog.csdn.net/qq_53079406/article/details/125266331

nmap使用教程：https://blog.csdn.net/qq_53079406/article/details/125263917

mascan使用教程：https://blog.csdn.net/qq_53079406/article/details/12526633

开放状态：Close Open Filtered

考虑：1、防火墙 2、内网环境

内网环境可能出现情况：明明数据库端口开的，网站也能正常打开，但是你对目标进行端口扫描，发现数据库端口没有开放（排除防火墙问题）

## 6、WAF识别

### （1）、WAF解释

Web应用防护系统（也称为：网站应用级入侵防御系统。英文：Web Application Firewall，简称：WAF）。利用国际上公认的一种说法：Web应用防火墙是通过执行一系列针对HTTP/HTTPS的安全策略来专门为Web应用提供保护的一款产品。

### （2）、WAF分类

- 云WAF：百度安全宝、阿里云盾、长亭雷池，华为云，亚马逊云等

- 硬件WAF：绿盟、安恒、深信服、知道创宇等公司商业产品

- 软件WAF：宝塔，安全狗、D盾等

- 代码级WAF：自己写的waf规则，防止出现注入等，一般是在代码里面写死的


### （3）、识别看图

拦截页面，identywaf项目内置

waf识别页面：https://blog.csdn.net/csdnmmd/article/details/122721133

### （4）、识别项目

识别WAF，可以在WAF指纹目录下自行编写脚本。这类WAF识别工具的原理基本都是根据HTTP头部信息、状态码以及WAF拦截页中的图片、文字作为特征来进行检测

- wafw00f：https://github.com/EnableSecurity/wafw00f

- identywaf：https://github.com/stamparm/identYwaf


## 7、蜜罐

### （1）、蜜罐解释

蜜罐是一种安全威胁的检测技术，其本质在于引诱和欺骗攻击者，并且通过记录攻击者的攻击日志来产生价值。安全研究人员可以通过分析蜜罐的被攻击记录推测攻击者的意图和手段等信息。攻击方可以通过蜜罐识别技术来发现和规避蜜罐。因此，我们有必要站在红队攻击者的角度钻研蜜罐识别的方式方法。

### （2）、蜜罐分类

根据蜜罐与攻击者之间进行的交互的程度可以将蜜罐分为三类:低交互蜜罐、中交互蜜罐、高交互蜜罐。当然还可以根据蜜罐模拟的目标进行分类，比如：数据库蜜罐、工控蜜罐、物联网蜜罐、Web蜜罐等等。

### （3）、蜜罐产品

![image-20230322234935847](C:\Users\MRJ\AppData\Roaming\Typora\typora-user-images\image-20230322234935847.png)

![img](https://docimg5.docs.qq.com/image/AgAABTZwlSKcM18oGZ1N5oVbsufo8vqA.png?w=664&h=915)

### （4）、蜜罐识别原理

https://mp.weixin.qq.com/s/jPz9hBmUypFyQlU27vglUg

### （5）、蜜罐识别技术

0、测试

大概了解组成功能等

蜜罐安装指南：https://hfish.net/#/

1、项目识别

- https://github.com/graynjo/Heimdallr
- https://github.com/360quake/quake_rs

​					quake.exe init apikey值

​					quake.exe honeypot 目标

2、人工

- 端口多而有规律性
- Web访问协议就下载
- 设备指纹分析（见上图）

3、网络空间

- 鹰图
- Quake

## 8、CND绕过

https://mp.weixin.qq.com/s/zxEH-HMqKukmq7qXfrdnQQ

国内服务商：

- 阿里云  百度云  七牛云 
- 又拍云 腾讯云  Ucloud
- 360  网宿科技 ChinaCache

国外服务商

- CloudFlare StackPath Fastly
- Akamai CloudFront Edgecast
- CDNetworks Google Cloud CDN
- CacheFly Keycdn Udomain CDN77

### （1）、访问目标主机的方式

1.传统访问：用户访问域名–>解析服务器IP–>访问目标主机

2.普通CDN：用户访问域名–><u>CDN节点</u>–>真实服务器IP–>访问目标主机

3.带WAF的CDN：用户访问域名–><u>CDN节点（WAF）</u>–>真实服务器IP–>访问目标主机

### （2）、CDN的配置

配置1：加速域名-需要启用加速的域名

​			 子域名获取真实IP（取决于配置的设置）

配置2：加速区域-需要启用加速的地区

配置3：加速类型-需要启用加速的资源

### （3）、CDN服务的识别&绑定访问

- 超级Ping：http://17ce.com/
- 超级Ping：https://ping.chinaz.com/
- 各地ping（出现多个IP即启用CDN服务）
- 利用 Nslookup 查询域名，看是否返回多个应答 IP

### （4）、CDN的绕过

**a、主动漏洞&遗留文件**

配置加速选项中只加速主域名，导致其他子域名未加速（解析IP可能同IP也可能C段）

接口查询：https://get-site-ip.com/

接口查询：https://fofa.info/extensions/source

使用网络空间&第三方功能集合查询判断

1、漏洞如：SSRF RCE等

利用漏洞让对方真实服务器主动出网连接，判断来源IP即真实IP

2、遗留文件：phpinfo类似功能

通过访问类似PHPINFO类似代码函数获取本地IP造成的地址泄漏

**b、邮件系统**

判断条件：<u>发信人是当前域名邮件用户名</u>

-让他主动给你发：

部署架设的邮件服务器如果向外部用户发送邮件的话，

那么邮件头部的源码中会包含此邮件服务器的真实IP地址。

常见的邮件触发点有：

- 1、RSS订阅
- 2、邮箱注册、激活处
- 3、邮箱找回密码处
- 4、产品更新的邮件推送
- 5、某业务执行后发送的邮件通知
- 6、员工邮箱、邮件管理平台等入口处的忘记密码

-你给未知邮箱发：（需要自己的邮件服务器不能第三方）

通过发送邮件给一个不存在的邮箱地址，因为该用户邮箱不存在，所以发送将失败，

并且还会收到一个包含发送该电子邮件给你的服务器的真实IP通知。

**c、全网扫描**

- 1、判断加速厂商
- 2、IP库筛地址段
- 3、配置范围扫描

先从IP段去扫描符合开放端口，再从IP去访问看看关键字，将符合结果进行保存！

厂商查询：https://tools.ipip.net/cdn.php

工具项目：

- https://www.cz88.net/geo-public

- https://github.com/Tai7sy/fuckcdn

## 9、框架

后端：

- CMS：一般PHP开发居多源码程序
- （利用源码程序名去搜漏洞情况，源码去下载进行后期的代码审计）

前端

- js 框架（爬取更多的js从里面筛选URL或敏感泄漏key等） 
- 也是可以通过对js代码逻辑进行代码审计

组件

- java居多，常见有过安全漏洞组件（shiro solr log4j sprintboot等）

框架

- php java python都有
- 框架：简单代码的一个整合库，如果使用框架就只需要学习使用框架调用即可
- 如：文件上传功能是需要很多代码来实现的，框架把这个代码进行封封装，调用即可
- 影响：如果采用框架开发，代码的安全性是取决于框架的过滤机制

组件

- 第三方的功能模块（日志记录，数据监控，数据转换等）

​    Web架构：

- 1、最简单最入门的开发模型（功能代码全部手写）

  最容易出现漏洞，程序员水平不一，没有第三方或团队的检测，单纯的自己写

- 2、结合开发框架的开发模型（以框架为核心实现功能）

  第三方或团队的开发的封装代码框架，一般内置的过滤机制（框架漏洞）

- 3、结合开发框架外加组件模型（以框架为核心，组件为辅实现功能）

  第三方或团队的开发的封装代码框架，一般内置的过滤机制（框架和组件漏洞）                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

指纹识别-本地工具-GotoScan（CMSEEK）

- 1、在线平台见前面课程，本地工具适用于不出网环境

  https://github.com/newbe3three/gotoscan

- 2、网络空间：Fofa Quake Hunter

- 3、网络空间：IO图标关系

## （1）、Python-开发框架

**Django&Flask**

Django

- 1、识别插件
- 2、Set-Cookie:expires=

Flask

- 1、识别插件
- 2、Set-Cookie:expires=

## （2）、PHP-开发框架

**ThinkPHP&Laravel&Yii**

ThinkPHP：

- 0、识别插件
- 1、X-Powered-By: ThinkPHP
- 2、CMS识别到源码体系TP开发

Laravel：

- 1、识别插件
- 2、Set-Cookie中特征的格式

Yii:

- 1、识别插件
- 2、Set-Cookie中特征的格式

## （3）、Java-框架组件

**Fastjson&Shiro&Solr&Spring**

52类110个主流Java组件和框架介绍：

https://blog.csdn.net/agonie201218/article/details/125300729

Fastjson/Jackson

- 在提交JSON数据包中修改测试：
- -Fastjson组件会把01解析成1
- -Jackson组件在解析01时会抛出异常
- https://forum.butian.net/share/1679
- https://www.iculture.cc/forum-post/24115.html

Shiro

- 请求包的cookie中存在rememberMe字段。
- 返回包中存在set-Cookie：remeberMe=deleteMe。
- 请求包中存在rememberMe=x时，响应包中存在rememberMe=deleteMe。
- 有时候服务器不会主动返回remeberMe=deleteMe，直接发包即可，将Cookie内容改为remember Me=1，若相应包有rememberMe=deleteMe，则基本可以确定网站apache shiro搭建的。

Struts2

- 一般使用struts2框架后缀带do或action，可以尝试进行利用

Springboot

- 1、通过web应用程序网页标签的小绿叶图标
- 2、通过springboot框架默认报错页面

Solr识别 

- 一般开放8983端口,访问页面也可以探针到

# 二、	APP应用

## 1、获取APP

### （1）、从名称获取APP

- 点点查：https://app.diandian.com/
- 小蓝本：https://www.xiaolanben.com/
- 七麦：https://www.qimai.cn/
- 爱企查：https://aiqicha.baidu.com/

### （2）、从URL获取APP

- 查备案信息再搜
- 网站上有APP下载
- 市场直接搜索APP

## 2、APP信息分类

### （1）、资产信息

- IP——服务端口
- 域名——web安全
- 接口——API安全

转到对应Web测试 接口测试 服务测试 

### （2）、泄露信息

- 邮箱配置
- 接口配置
- OSS配置

key的利用

### （3）、代码信息

Java代码安全问题，APP的加密不完整（逆向相关）

## 3、APP信息提取技术

### （1）、逆向静态提取（反编译从源码中获取数据）

- 优点：数据较为完整
- 缺点：有很多无用的资产

平台：

- 南明离火：https://www.zhihuaspace.cn:8888/

- 摸瓜：https://mogua.co/

- APPinfoscanner：https://github.com/kelvinBen/AppInfoScanner

- MobSF：https://github.com/MobSF/Mobile-Security-Framework-MobSF（MobSF安装参考：

  https://www.cnblogs.com/B-hai/p/15696948.html

  https://blog.csdn.net/ljh824144294/article/details/119181803）

案例：某APP打开无数据包，登录有数据包（反编译后未找到目标资产，抓包住到了）

原因：那个登录界面是APP打包的资源，并没有对外发送数据

### （2）、动态抓包提取	

- 优点：没有误报
- 缺点：无法做到完整

### （3）、动态调试提取

- 优点：没有误报，解决不能抓包不能代理等情况、搞逆向的人能看到实时的app调用链等
- 缺点：无法做到完整

# 三、小程序应用

## 1、获取小程序

各大平台关键字搜素

- -微信
- -百度
- -支付宝
- -抖音头条

## 2、小程序的主体

小程序搭建测试：https://qz.fkw.com/

### （1）、主体结构

小程序包含一个描述整体程序的 app 和多个描述各自页面的 page。

一个小程序主体部分(即app)由三个文件组成，必须放在项目的根目录，如下：

| 文件                  必需                 作用              |      |      |
| :----------------------------------------------------------- | ---- | ---- |
| app.js                  是                      小程序逻辑   |      |      |
| app.json              是                     小程序公共配置  |      |      |
| app.wxss             否                     小程序公共样式表 |      |      |

### （2）、组成文件

一个小程序页面由四个文件组成，分别是:     

- ​    xxx.js        页面逻辑
-    xxx.json      页面配置
- ​    xxx.wxml      页面结构
- ​    xxx.wxss      页面样式

### （3）、项目整体目录结构

- ​    pages                页面文件夹
- ​    index                首页
- ​    logs                 日志
- ​    utils               
- ​    util                 工具类(mina框架自动生成,你也可以建立一个：api)
- ​    app.js               入口js(类似于java类中的main方法)、全局js
- ​    app.json             全局配置文件
- ​    app.wxss             全局样式文件
- ​    project.config.json  跟你在详情中勾选的配置一样
- ​    sitemap.json         用来配置小程序及其页面是否允许被微信索引

## 3、小程序抓包

小程序抓包-Proxifier&BurpSuite联动

- -对抓到的IP或域名进行Web安全测试
- -对抓到的IP或域名进行API安全测试
- -对抓到的IP或域名进行端口服务测试

## 4、小程序逆向-解包反编译&动态调试&架构

对源码架构进行分析

- -更多的资产信息
- -敏感的配置信息
- -未授权访问测试
- -源码中的安全问题

小程序多功能组手

复杂操作：https://www.cnblogs.com/oodcloud/p/16964878.html

简单工具：http://xcx.siqingw.top/

# 四、微信公众号

## 1、获取微信公众号

- 企查信息知识产权
- 搜购搜索
- 微信直接搜索

## 2、资产

直接看微信公众号业务功能是否有第三方网站或服务

# 五、其他信息

## 1、GitHub

目标中开发人员或者托管公司上传的项目存在源码泄漏或配置信息（密码密匙等），人员数据库等敏感信息，找到多个脆弱点。

1、人员&域名&邮箱等筛选

eg：xxx.cn password in:file

- https://gitee.com/
- https://github.com/
- https://www.huzhan.com/

GITHUB资源搜索：

```text
in:name test               #仓库标题搜索含有关键字 
in:descripton test         #仓库描述搜索含有关键字 
in:readme test             #Readme文件搜素含有关键字 
stars:>3000 test           #stars数量大于3000的搜索关键字 
stars:1000..3000 test      #stars数量大于1000小于3000的搜索关键字 
forks:>1000 test           #forks数量大于1000的搜索关键字 
forks:1000..3000 test      #forks数量大于1000小于3000的搜索关键字 
size:>=5000 test           #指定仓库大于5000k(5M)的搜索关键字 
pushed:>2019-02-12 test    #发布时间大于2019-02-12的搜索关键字 
created:>2019-02-12 test   #创建时间大于2019-02-12的搜索关键字 
user:test                  #用户名搜素 
license:apache-2.0 test    #明确仓库的 LICENSE 搜索关键字 
language:java test         #在java语言的代码中搜索关键字 
user:test in:name test     #组合搜索,用户名test的标题含有test的
```

关键字配合谷歌搜索：

```text
site:Github.com smtp   
site:Github.com smtp @qq.com   
site:Github.com smtp @126.com   
site:Github.com smtp @163.com   
site:Github.com smtp @sina.com.cn 
site:Github.com smtp password 
site:Github.com String password smtp
```

2、语法固定长期后续监控新泄露

-基于关键字监控

-基于项目规则监控

- https://github.com/madneal/gshark
- https://github.com/NHPT/FireEyeGoldCrystal
- https://github.com/Explorer1092/Github-Monitor

## 2、网盘资源

主要就是查看网盘中是否存有目标的敏感文件

如：企业招标，人员信息，业务产品，应用源码等

## 3、敏感目录文件

- 字典扫描
- 爬虫

## 4、网络空间进阶

- 证书资产 
- ICO资产
- 邮箱资产

# 六、自动化项目

## 各类红蓝队优秀工具项目集合

https://github.com/guchangan1/All-Defense-Tool

本项目集成了全网优秀的开源攻防武器项目，包含信息收集工具（自动化利用工具、资产发现工具、目录扫描工具、子域名收集工具、指纹识别工具、端口扫描工具、各种插件...），漏洞利用工具（各大CMS利用工具、中间件利用工具等项目...），内网渗透工具（隧道代理、密码提取...）、应急响应工具、甲方运维工具、等其他安全攻防资料整理，供攻防双方使用。如果你有更好的建议，欢迎提出请求。

## 自动化-武器库部署-F8x

项目地址：https://github.com/ffffffff0x/f8x

1、介绍：

一款红/蓝队环境自动化部署工具,支持多种场景,渗透,开发,代理环境,服务可选项等.

2、配置：

通过 CF Workers 下载 [推荐]

wget : wget -O f8x https://f8x.io/

curl : curl -o f8x https://f8x.io/

3、使用：见项目文档

## 自动化-网络空间-AsamF

项目地址：https://github.com/Kento-Sec/AsamF

1、介绍：

AsamF集成了Fofa、Hunter、Quake、Zoomeye、Shodan、爱企查、Chinaz、0.zone、subfinder。AsamF支持Fofa、Hunter、Quake、Zoomeye、Shodan、Chinaz、0.zone配置多个Key。

2、配置：

AsamF会在~/.config/asamf/目录下生成config.json文件。

如果你有多个key，按照json的格式录入即可，建议键值按照阿拉伯数字依次录入,方便以阿拉伯数字来切换key。自动结果保存在~/asamf/目录下。

3、使用：见项目文档

## 自动化-企查信息-ENScan

项目地址：https://github.com/wgpsec/ENScan_GO

1、介绍：

剑指HW/SRC，解决在HW/SRC场景下遇到的各种针对国内企业信息收集难题

2、配置：

ENScanGo在第一次使用时需要使用-v命令生成配置文件信息后进行配置

3、使用：见项目文档

## 自动化-综合架构-ARL&Nemo

### -ARL灯塔

项目地址：https://github.com/TophantTechnology/ARL

1、介绍：

旨在快速侦察与目标关联的互联网资产，构建基础资产信息库。 协助甲方安全团队或者渗透测试人员有效侦察和检索资产，发现存在的薄弱点和攻击面。

2、配置：（docker搭建）

git clone https://github.com/TophantTechnology/ARL

cd ARL/docker/

docker volume create arl_db

docker-compose pull

docker-compose up -d

3、使用：见直播操作



### -Nemo_Go

项目地址：https://github.com/hanc00l/nemo_go

1、介绍：

Nemo是用来进行自动化信息收集的一个简单平台，通过集成常用的信息收集工具和技术，实现对内网及互联网资产信息的自动收集，提高隐患排查和渗透测试的工作效率，用Golang完全重构了原Python版本。

2、配置：（docker搭建）

https://github.com/hanc00l/nemo_go/blob/main/docs/docker.md

下载release的nemo_linux_amd64.tar后执行：

mkdir nemo;tar xvf nemo_linux_amd64.tar -C nemo;cd nemo

docker-compose up -d

3、使用：见直播操作

4、Bug：网络空间（配置后要重启）

https://github.com/hanc00l/nemo_go/issues/72
